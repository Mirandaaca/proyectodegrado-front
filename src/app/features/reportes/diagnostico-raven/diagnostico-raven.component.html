<div class="container mx-auto py-6 px-4">
    <!-- Encabezado -->
    <div class="bg-white rounded-lg shadow-sm border p-6 mb-6" @fadeIn>
      <div class="flex justify-between items-center">
        <div>
          <h1 class="text-3xl font-bold text-gray-800 mb-2">Diagnósticos Test de Raven</h1>
          <p class="text-gray-600">Listado de evaluaciones y resultados</p>
        </div>
        
        <button mat-raised-button color="primary" (click)="generarReporte()" class="hover:scale-105 transition-transform">
          <mat-icon>picture_as_pdf</mat-icon>
          Generar Reporte
        </button>
      </div>
    </div>
  
    <!-- Filtros -->
    <div class="bg-white rounded-lg shadow-sm border p-6 mb-6" @fadeIn>
      <form [formGroup]="filtrosForm" class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <mat-form-field appearance="outline">
          <mat-label>Buscar</mat-label>
          <input matInput formControlName="busqueda" placeholder="Nombre del postulante...">
          <mat-icon matSuffix>search</mat-icon>
        </mat-form-field>
  
        <mat-form-field appearance="outline">
          <mat-label>Fecha Inicio</mat-label>
          <input matInput [matDatepicker]="pickerInicio" formControlName="fechaInicio">
          <mat-datepicker-toggle matSuffix [for]="pickerInicio"></mat-datepicker-toggle>
          <mat-datepicker #pickerInicio></mat-datepicker>
        </mat-form-field>
  
        <mat-form-field appearance="outline">
          <mat-label>Fecha Fin</mat-label>
          <input matInput [matDatepicker]="pickerFin" formControlName="fechaFin">
          <mat-datepicker-toggle matSuffix [for]="pickerFin"></mat-datepicker-toggle>
          <mat-datepicker #pickerFin></mat-datepicker>
        </mat-form-field>
  
        <div class="flex items-center">
          <button 
            mat-button 
            color="warn" 
            (click)="limpiarFiltros()"
            class="h-[56px] hover:bg-red-50 transition-colors">
            <mat-icon>clear</mat-icon>
            Limpiar Filtros
          </button>
        </div>
      </form>
    </div>
  
    <!-- Tabla -->
    <div class="bg-white rounded-lg shadow-sm border overflow-hidden" @fadeIn>
      <table mat-table [dataSource]="diagnosticos" class="w-full">
        <!-- Postulante Column -->
        <ng-container matColumnDef="postulante">
          <th mat-header-cell *matHeaderCellDef class="bg-gray-50 font-bold"> Postulante </th>
          <td mat-cell *matCellDef="let diagnostico"> {{diagnostico.nombrePostulante}} </td>
        </ng-container>
  
        <!-- Fecha Column -->
        <ng-container matColumnDef="fecha">
          <th mat-header-cell *matHeaderCellDef class="bg-gray-50 font-bold"> Fecha </th>
          <td mat-cell *matCellDef="let diagnostico"> 
            {{diagnostico.fechaCita | date:'dd/MM/yyyy HH:mm'}} 
          </td>
        </ng-container>
  
        <!-- Acciones Column -->
        <ng-container matColumnDef="acciones">
          <th mat-header-cell *matHeaderCellDef class="bg-gray-50 font-bold w-20"> Acciones </th>
          <td mat-cell *matCellDef="let diagnostico">
            <button 
              mat-icon-button 
              color="primary"
              (click)="verDetalle(diagnostico.idDiagnostico); $event.stopPropagation()"
              matTooltip="Ver detalle"
              class="hover:scale-110 transition-transform">
              <mat-icon>visibility</mat-icon>
            </button>
          </td>
        </ng-container>
  
        <tr mat-header-row *matHeaderRowDef="['postulante', 'fecha', 'acciones']"></tr>
        <tr 
          mat-row 
          *matRowDef="let row; columns: ['postulante', 'fecha', 'acciones']"
          class="hover:bg-gray-50 transition-colors cursor-pointer"
          (click)="verDetalle(row.idDiagnostico)">
        </tr>
      </table>
  
      <!-- Estado vacío -->
      <div 
        *ngIf="diagnosticos.length === 0" 
        class="p-8 text-center text-gray-500">
        <mat-icon class="text-6xl mb-4 text-gray-300">psychology</mat-icon>
        <p>No se encontraron diagnósticos con los filtros aplicados</p>
      </div>
    </div>
  </div>